# handler configuration for apigee adapter
apiVersion: "config.istio.io/v1alpha2"
kind: apigee
metadata:
 name: apigee_handler
 namespace: istio-config-default
spec:
 apid_base: http://192.168.64.17:31625/
 org_name: edgexfeb1
---
# template 'auth' instance
apiVersion: "config.istio.io/v1alpha2"
kind: auth
metadata:
 name: apigee_auth
 namespace: istio-config-default
spec:
 apikey: request.headers["apikey"] | ""
 uripath: request.path | "/"
 auth_fail_message: apigee.authFailMessage
---
# handler dispatch rule
apiVersion: "config.istio.io/v1alpha2"
kind: rule
metadata:
 name: apigeerule
 namespace: istio-config-default
spec:
 match: "true"
 actions:
 - handler: apigee_handler.apigee # name.kind.namespace (ns optional)
   instances:
   - apigee_analytics.logentry
   - apigee_auth.auth
